<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Groups Page</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"
    integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            color: #000;
            background-color: #fff;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }
        a {
            color: #000;
            text-decoration: underline;
        }
        #input-container {
            display: none;
        }
    </style>
</head>
<body>
    <table id="groups-table">
        <tr>
            <th>#</th>
            <th>Group</th>
            <th>Description</th>
        </tr>
    </table>
    <div id="input-container">
        <input type="text" id="email-input" placeholder="Enter your email">
        <button id="add-button">Add</button>
    </div>
    <script>
        var selectedGroupId = null;

        // Fetch groups from the backend API
        $.getJSON("https://zqikycpua2.execute-api.us-east-1.amazonaws.com/Prod/groups", function(data) {
            $.each(data, function(key, group) {
                $("#groups-table").append(`<tr>
                                            <td>${key + 1}</td>
                                            <td><a href="#" class="group-link" data-id="${group.id}">${group.name}</a></td>
                                            <td>${group.description}</td>
                                          </tr>`);
            });
        });

        // Event listener for clicking on a group link
        $(document).on("click", ".group-link", function(e) {
            e.preventDefault();
            selectedGroupId = $(this).data("id");
            $("#input-container").show();
        });

        // Event listener for clicking the Add button
        $("#add-button").click(function() {
            var email = $("#email-input").val();
            // Send API request with group ID and email
            $.ajax({
              url: `https://zqikycpua2.execute-api.us-east-1.amazonaws.com/Prod/groups/${selectedGroupId}`,
              type: "POST",
              contentType: "application/json",
              data: JSON.stringify({ email: email }),
              success: function() {
                alert("Email added successfully!");
                $("#input-container").hide();
                $("#email-input").val("");
              }
            });
        });
    </script>
</body>
</html>
